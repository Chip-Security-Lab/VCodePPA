Pattern matcher with dual reset