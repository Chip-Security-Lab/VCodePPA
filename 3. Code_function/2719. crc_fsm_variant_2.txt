CRC-16 calculator with state machine