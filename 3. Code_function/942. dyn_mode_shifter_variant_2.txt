Multi-mode shifter with Karatsuba multiplication