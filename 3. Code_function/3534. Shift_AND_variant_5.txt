Pipelined shift-and mask processor