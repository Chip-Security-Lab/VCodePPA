Multi-stage configurable data shift register