Five-stage data pipeline buffer