JK flip-flop with hierarchical modules