Bidirectional priority encoder with validation