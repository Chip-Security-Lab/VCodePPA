Pipelined data buffer with handshaking