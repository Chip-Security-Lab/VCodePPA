Edge detection with counter pipeline