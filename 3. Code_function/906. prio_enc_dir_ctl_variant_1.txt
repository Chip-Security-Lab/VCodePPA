Pipelined priority encoder with direction