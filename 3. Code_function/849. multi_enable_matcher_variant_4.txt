Two-stage pattern matcher circuit