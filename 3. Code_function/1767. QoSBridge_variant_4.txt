Priority-based data queue controller