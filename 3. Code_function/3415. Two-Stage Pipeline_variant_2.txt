Four-stage pipelined data processor