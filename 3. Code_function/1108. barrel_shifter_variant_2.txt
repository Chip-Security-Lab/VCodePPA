Bidirectional barrel shifter with Karatsuba