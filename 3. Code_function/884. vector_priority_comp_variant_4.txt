Masked priority encoder with validation