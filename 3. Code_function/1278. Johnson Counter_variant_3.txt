Johnson counter with handshake protocol