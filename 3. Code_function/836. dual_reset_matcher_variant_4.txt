Dual-reset qualified pattern matcher