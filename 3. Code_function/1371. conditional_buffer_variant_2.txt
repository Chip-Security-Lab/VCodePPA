Threshold-based data buffer controller