Ping-pong buffer with data switching