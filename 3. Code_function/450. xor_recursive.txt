Recursive bitwise XOR with propagation