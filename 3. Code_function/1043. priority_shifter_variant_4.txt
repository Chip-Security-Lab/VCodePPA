Priority-based data shifter with handshaking