Pipelined circular buffer with snapshots