Masked data buffer with backpressure