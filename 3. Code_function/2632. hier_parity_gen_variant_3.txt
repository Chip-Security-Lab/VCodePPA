Hierarchical parity calculator with handshaking