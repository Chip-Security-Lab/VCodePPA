CRC16 calculation with error detection