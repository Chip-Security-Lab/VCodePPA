Pipelined demux with flow control