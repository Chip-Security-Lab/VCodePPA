Atomic memory read-modify-write operation