Weighted priority encoder with registers