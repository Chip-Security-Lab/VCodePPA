Protocol demultiplexer with pipeline stages