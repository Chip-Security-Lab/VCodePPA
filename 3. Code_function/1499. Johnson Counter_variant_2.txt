Pipelined Johnson counter with buffers