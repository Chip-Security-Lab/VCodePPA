Three-stage pipelined data buffer