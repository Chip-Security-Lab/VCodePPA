Run-length encoder with handshaking