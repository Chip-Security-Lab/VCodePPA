Tree-based data parity calculator