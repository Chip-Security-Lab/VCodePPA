Memory access control state machine