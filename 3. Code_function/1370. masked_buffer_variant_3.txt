Pipelined masked data buffer controller