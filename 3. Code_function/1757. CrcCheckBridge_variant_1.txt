CRC calculation with error detection