PTP timestamp generation with synchronization