Three-stage ready-valid handshaking buffer