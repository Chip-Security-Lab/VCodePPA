QoS-based pipelined priority arbiter