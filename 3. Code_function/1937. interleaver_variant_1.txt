Matrix transpose with hierarchical design