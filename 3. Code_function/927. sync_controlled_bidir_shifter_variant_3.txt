Bidirectional shifter with handshaking protocol