Three-stage enabled data pipeline