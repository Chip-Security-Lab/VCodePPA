Pipelined mux with shift operations