Pipelined data transformation with backpressure