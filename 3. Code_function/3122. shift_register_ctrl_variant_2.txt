Configurable shift register with FSM