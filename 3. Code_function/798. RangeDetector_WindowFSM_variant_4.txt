Window crossing detector with FSM