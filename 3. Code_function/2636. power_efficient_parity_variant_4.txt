Hierarchical parity generator with handshaking