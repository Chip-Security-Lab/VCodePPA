Two-stage input history tracker