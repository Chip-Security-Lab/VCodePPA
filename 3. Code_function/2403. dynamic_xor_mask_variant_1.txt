Dynamic XOR encryption with mask