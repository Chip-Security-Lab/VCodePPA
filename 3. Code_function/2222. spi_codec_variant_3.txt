SPI controller with data transfer