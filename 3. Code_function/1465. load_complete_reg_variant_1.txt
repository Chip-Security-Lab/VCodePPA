Three-stage data pipeline controller