Pipelined variable-length bidirectional shifter