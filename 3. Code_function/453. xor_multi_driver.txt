XOR with redundant validation logic