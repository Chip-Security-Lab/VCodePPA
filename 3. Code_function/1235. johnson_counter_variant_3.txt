Pipelined Johnson counter with valid