Two-stage data pipeline controller