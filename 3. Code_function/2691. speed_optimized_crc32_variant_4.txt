CRC32 calculation with handshaking protocol