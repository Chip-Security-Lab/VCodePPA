Three-stage pipelined data processor