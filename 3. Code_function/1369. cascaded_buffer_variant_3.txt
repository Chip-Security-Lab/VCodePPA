Two-stage cascaded data pipeline