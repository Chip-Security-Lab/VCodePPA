Three-stage FIFO data pipeline