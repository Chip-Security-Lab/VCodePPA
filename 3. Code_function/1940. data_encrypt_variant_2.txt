Data encryption with buffered pipeline