Priority-based encoder with grant output