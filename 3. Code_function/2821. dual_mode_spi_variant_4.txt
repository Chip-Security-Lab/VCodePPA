Dual-mode SPI communication controller