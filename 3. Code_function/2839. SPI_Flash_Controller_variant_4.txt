SPI flash controller with pipelining