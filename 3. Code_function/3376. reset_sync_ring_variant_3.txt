Data ring buffer with handshaking