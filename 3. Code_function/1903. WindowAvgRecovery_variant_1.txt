Moving average filter with buffer