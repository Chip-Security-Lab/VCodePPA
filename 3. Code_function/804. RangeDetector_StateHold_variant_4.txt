Threshold detector with state memory