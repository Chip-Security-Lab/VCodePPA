Threshold counter with reset generation