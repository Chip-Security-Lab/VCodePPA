Three-stage pipeline with backpressure