Bidirectional data demux with processing