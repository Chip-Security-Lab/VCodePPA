USB device state machine controller