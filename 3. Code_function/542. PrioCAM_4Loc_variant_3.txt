Content addressable memory with handshaking