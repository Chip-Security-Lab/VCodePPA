Pipelined variable-width SPI controller