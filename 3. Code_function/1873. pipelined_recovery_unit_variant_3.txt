Three-stage pipelined data processing