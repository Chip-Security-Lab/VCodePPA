Multi-stage pipelined data processor