Two-stage synchronous data pipeline