Authenticated encryption with FSM control