Max heap implementation with pipelining