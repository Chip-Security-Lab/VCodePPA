Masked shift and XOR circuit