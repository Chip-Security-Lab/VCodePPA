Pipelined FSM with clock gating