Bidirectional priority encoder with selection