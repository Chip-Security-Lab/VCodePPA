Pattern matcher with timeout counter