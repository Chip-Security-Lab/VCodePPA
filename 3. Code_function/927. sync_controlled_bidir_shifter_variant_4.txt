Bidirectional shifter with Karatsuba multiplier