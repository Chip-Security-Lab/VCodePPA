Weighted random output generator pipeline