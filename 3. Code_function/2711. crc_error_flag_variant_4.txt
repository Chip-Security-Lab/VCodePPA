CRC calculation and error detection