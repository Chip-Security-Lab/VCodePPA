Feedback-controlled adaptive PWM generator