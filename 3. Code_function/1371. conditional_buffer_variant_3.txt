Threshold-filtered data buffer with handshaking