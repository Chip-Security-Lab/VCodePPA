Bidirectional shift register with pipelining