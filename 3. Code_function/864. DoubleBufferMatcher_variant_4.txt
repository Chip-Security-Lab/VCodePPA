Pattern matcher with double buffer