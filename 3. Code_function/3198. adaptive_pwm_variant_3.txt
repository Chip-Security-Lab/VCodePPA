Adaptive PWM with feedback control