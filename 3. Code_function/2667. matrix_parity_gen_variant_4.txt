Matrix parity generator with handshaking