Multiply and bitwise-AND state machine