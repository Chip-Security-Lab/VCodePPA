I2C controller with pipelined design