Masked CRC calculation with handshaking