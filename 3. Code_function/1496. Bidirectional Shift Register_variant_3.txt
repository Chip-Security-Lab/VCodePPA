Bidirectional shift register with buffers