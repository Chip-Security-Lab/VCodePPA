Two-stage tri-state data pipeline