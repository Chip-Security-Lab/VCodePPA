Multi-stage input history tracker