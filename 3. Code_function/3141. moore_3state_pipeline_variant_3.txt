Three-stage data pipeline with valid.