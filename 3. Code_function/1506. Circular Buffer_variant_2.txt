Pipelined circular buffer with shifts