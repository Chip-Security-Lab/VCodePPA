Barrel shifter with handshaking protocol