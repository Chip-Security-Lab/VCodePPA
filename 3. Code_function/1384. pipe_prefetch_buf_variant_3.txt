Three-stage pipeline with subtractor