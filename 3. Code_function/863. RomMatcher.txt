Pattern matcher using ROM lookup