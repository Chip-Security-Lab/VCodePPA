Bidirectional variable shifter with handshaking