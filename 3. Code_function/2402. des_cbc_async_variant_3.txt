DES CBC encryption with handshaking