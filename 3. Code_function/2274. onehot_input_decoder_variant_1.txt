Onehot-to-binary encoder with validation