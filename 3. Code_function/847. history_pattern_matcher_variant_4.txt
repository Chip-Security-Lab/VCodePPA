Pattern matcher with shift register