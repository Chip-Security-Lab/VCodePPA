Pipelined demultiplexer using state machine