Rotating counter with handshake protocol