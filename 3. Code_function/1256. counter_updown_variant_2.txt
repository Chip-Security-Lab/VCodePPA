Bidirectional counter with buffer registers