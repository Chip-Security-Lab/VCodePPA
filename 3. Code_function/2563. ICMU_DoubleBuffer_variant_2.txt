Double-buffered pipelined data switching