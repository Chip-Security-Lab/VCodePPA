Pipelined FIFO buffer with handshaking