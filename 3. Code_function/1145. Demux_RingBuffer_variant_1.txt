Parameterized ring buffer with demux