SPI flash controller FSM implementation