Pipelined data shifter with control