Clock-gated flip-flop with preprocessing