Programmable timer with multiple modes