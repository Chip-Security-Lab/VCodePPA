Bidirectional shifter with variable magnitude