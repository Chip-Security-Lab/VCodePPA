Multi-stage pipelined data buffer