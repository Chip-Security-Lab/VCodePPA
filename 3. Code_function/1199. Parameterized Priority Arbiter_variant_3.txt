Priority-based arbiter with grants