Tree parity calculator with handshaking