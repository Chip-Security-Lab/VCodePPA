Sequence detector with pattern matching