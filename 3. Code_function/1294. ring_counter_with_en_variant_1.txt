Pipelined ring counter with handshaking