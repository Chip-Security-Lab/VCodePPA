Three-stage pipelined FIFO codec