Adaptive threshold for signal detection