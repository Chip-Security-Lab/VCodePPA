Three-stage sequential data pipeline