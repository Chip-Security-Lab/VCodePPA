Two-stage pipelined data processor