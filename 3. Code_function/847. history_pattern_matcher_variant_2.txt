Pattern matching with shift register