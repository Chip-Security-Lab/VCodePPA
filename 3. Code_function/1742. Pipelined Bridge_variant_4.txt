Three-stage pipeline with subtraction