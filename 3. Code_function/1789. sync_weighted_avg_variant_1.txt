Weighted average with pipeline registers