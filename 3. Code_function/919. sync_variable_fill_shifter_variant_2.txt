Variable-fill bidirectional barrel shifter