Three-stage resetable data pipeline