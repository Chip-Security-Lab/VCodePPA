Pipelined dual-mode SPI interface controller