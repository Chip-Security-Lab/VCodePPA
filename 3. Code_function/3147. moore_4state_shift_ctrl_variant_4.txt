Pipelined shift controller with handshaking