Pipelined three-state pattern matcher