Dynamic XOR masking with borrowing