Pipelined ring counter with shifts