Configurable multi-stage logic processor