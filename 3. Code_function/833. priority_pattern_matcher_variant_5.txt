Priority-based pattern matching detector