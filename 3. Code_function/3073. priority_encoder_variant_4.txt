Pipelined priority encoder with FSM