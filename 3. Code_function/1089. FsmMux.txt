Channel-switching finite state machine