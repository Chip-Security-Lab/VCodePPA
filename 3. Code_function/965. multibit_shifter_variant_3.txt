Three-stage pipelined data shifter