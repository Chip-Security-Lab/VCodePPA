Hierarchical dual-rail data encoder