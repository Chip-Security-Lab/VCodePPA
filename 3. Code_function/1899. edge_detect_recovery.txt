Edge detection with counter circuit