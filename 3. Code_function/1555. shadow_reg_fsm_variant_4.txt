Two-stage data transfer FSM