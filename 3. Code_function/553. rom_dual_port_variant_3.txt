Dual-port memory with registers