Three-stage tagged data pipeline