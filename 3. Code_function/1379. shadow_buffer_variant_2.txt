Pipelined data buffering with handshaking