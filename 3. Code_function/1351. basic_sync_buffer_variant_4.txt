Three-stage synchronous data pipeline