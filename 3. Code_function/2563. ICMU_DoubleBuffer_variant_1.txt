Double buffer with context swapping