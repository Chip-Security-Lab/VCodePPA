Pipeline with conditional data shifting