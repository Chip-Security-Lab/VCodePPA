XOR with buffered processing stages