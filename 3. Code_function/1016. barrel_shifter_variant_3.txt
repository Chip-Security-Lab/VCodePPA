Bidirectional barrel shifter with rotation