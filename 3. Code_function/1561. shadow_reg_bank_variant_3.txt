Pipelined memory with three stages