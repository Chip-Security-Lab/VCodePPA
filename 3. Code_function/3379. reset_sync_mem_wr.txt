Synchronous two-stage data pipeline